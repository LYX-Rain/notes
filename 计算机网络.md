# 计算机网络

## 信息网络

### 分类

- 电话通信网（以话音通信为主）
- 计算机通信网络（（以数据通信为主）
- 有线电视网（以视频通信为主）

#### 计算机网络

- 局域网（LAN）
- 城域网（MAN）
- 广域网（WAN）

### 网络分层模型

#### OSI 模型

- 应用层
  - 直接面向用户，向应用程序直接提供服务
  - 以用户数据报文为单位
- 表示层
  - 主要解决用户信息的语法表示问题（编/解码、压缩、加密/解密）
  - 以报文为单位
- 会话层
  - 组织和协商两个表示层进程之间的会话
  - 与运输层一起，为用户建立一条逻辑信道
- 运输层
  - 为会话层提供了一个可靠的端到端的服务
  - 建立、拆除和管理端系统的会话连接
  - 对数据进行分段/合段或者分割/拼接等处理，组成运输层报文(分段报文)
- 网络层
  - 路由选择、数据包的分段和重组以及拥塞控制等
  - 网络层可以不存在
- （数据）链路层
  - 负责数据链路的建立、维持和拆除，并在两个相邻节点的线路上，将网络层送下来的信息(分组)组成帧
  - 具有差错控制功能和简单的流量控制功能
  - 实现在不可靠的物理链路上进行可靠的数据传输
- 物理层
  - 规定了计算机或终端与通信设备之间的接口标准
  - 包含接口的物理、电气、功能与规程四个方面的特性

###网络传输原理

#### 信道复用技术

- 频分复用 FDM
- 同步时分复用 TDM
  - 用户数据在每个 TDM 帧的位置不变
- 统计时分复用 STDM
  - 动态分配时隙，需要添加标识以区分用户数据
- 波分复用 WDM

#### 面向连接网络和无连接网络

- 面向连接网络：实连接和虚连接
  - 实连接：建立的连接由一条接一条的专用电路资源连接而成，无论是否有用户信息传递，这条专用连接始终存在
  - 虚连接：电路的分配是随机的，用户有信息传送时才占用电路资源(带宽根据需要分配)，无信息传送就不占用电路资源，对用户的识别改用标志，即一条连接使用相同标志统计占用的电路资源
  - 都有建立连接、信息传送、释放连接三个步骤；节点中需要有维持连接的状态表
- 无连接网络
  - 传输数据时并不事先建立连接，而是由交换设备做出路由选择
  - 同样的目的地可以从不同的路径到达

## 电话通信网络

### 电路交换原理

- 电话通信对时延和时延抖动敏感，而对差错不敏感
- 此当用户需要通信时，交换机就在收、发终端之间建立一条临时的电路连接，该连接在通信期间始终保持接通，直至通信结束才被释放
- 通信中交换机不需要对信息进行差错检验和纠正，但要求处理时延要小

#### 特点

1. 整个通信连接期间始终有一条电路被占用，即使在寂静期也是如此。即使在没有信息传送时别人也不能利用，所以采用电路交换进行数据通信的效率较低。
2. 电路是“透明”的，即发送端用户送出的信息通过交换节点连接时毫无限制地被传送到接收端。未对用户信息进行任何修正或解释。
3. 对于一个固定的连接，其信息传输时延是固定的。
4. 固定分配带宽资源，信息传送的速率恒定。造成网络资源的利用率降低，不适合突发业务传送。
5. 通信双方在信息传输速率、编码格式、同步方式、通信规程等方面要完全兼容，不同速率和不同通信协议之间的用户无法接通。
6. 存在着呼损。

### 电路交换机的硬件结构

- 总体结构包括硬件和软件两部分
- 硬件结构分为话路子系统和控制子系统
- 话路子系统主要由接口电路和交换网络
- 接口：
1. 模拟用户接口——连接模拟用户线和数字程控交换机，馈电（B）、过压保护（O）、振铃（R）、监视（S）、编译码（C）、混合电路（H）、测试（H）
2. 数字用户接口——连接用户端且环线采用数字传输，复用器/分路器、信令插入和提取（S）、收发器（R）、馈电（B）、过压保护（O）、测试（T）
3. 模拟中继接口——测试、过压保护、线路信令监视和配合、编/译码等功能
4. 数字中继接口——码型变换、时钟提取、帧同步和复帧同步、帧定位、信令插入和提取、告警检测等功能

### 七号信令系统

- 信令：在通信网上为完成某一通信业务，节点之间要相互交换的控制信息
- 信令系统：控制信息的语法、语义、信息传递的时序流程以及产生、发送和接收这些控制信息的软、硬件共同组成的集合体
- 随路信令系统的特点是信令与用户信息在同一条信道上传送
- 公共信道信令系统的特点是信令在一条与用户信息信道分开的信道上传送，并且该信令信道并非某一个用户信息信道的专用信令信道，而是为一群用户信息信道所共享
  - 信令系统独立于业务网，具有改变和增加信令而不影响现有业务网业务的灵活性
  - 便于实现信令系统的集中维护管理，降低信令系统的成本和维护开销

### 数据通信网络

#### 分组交换网络

- 基本思想：
- 把用户信息分成若干个具有统一格式的小数据块（分组 packet）
- 每个分组都有含有用于控制和选路信息的分组头
- 这些分组以“存储-转发”的方式在网内传输，即每个交换节点首先对收到的分组进行暂时存储，分析该分组头中有关选路的信息，进行路由选择，并在选择的路由上进行排队等待传输

#### 逻辑信道

- 逻辑信道号 LCN 由逻辑信道群号及群内逻辑信道号组成
- 在统计复用器有终端号和逻辑信道号的对照表，网络通过 LCN 就可以识别出是哪个终端发来的数据

#### 虚电路和数据报

- 分组在通过数据网时有两种方式：虚电路VC（Virtual Circuit）方式，数据报DG（Data Gram）方式 

##### 虚电路

- 两终端用户在相互传送数据之前要通过网络建立一条端到端的逻辑上的虚连接，称为虚电路。
- 通信需要经历连接建立、数据传输、连接拆除三个阶段，是面向连接的方式
- 路由选择仅仅发生在虚电路建立的时候，减少节点不必要的通信处理；分组的传输时延较小；减少每一分组的额外开销；由多段逻辑信道构成的，每一个虚电路在它经过的每段物理链路上都有一个逻辑信道号，这些逻辑信道级连构成了端到端的虚电路。
- 缺点：当网络中线路或者设备发生故障时，可能导致虚电路中断，必须重新建立连接。
- 使用场合：虚电路适用于一次建立后长时间传送数据的场合，其持续时间应显著大于呼叫建立时间，如文件传送、传真业务等。

##### 数据报

- 交换节点将每一个分组独立地进行处理，即每一个数据分组中都含有终点地址信息，当分组到达节点后，节点根据分组中包含的终点地址为每一个分组独立地寻找路由。无连接 
- 短报文通信效率比较高
- 每个节点可以自由地选路，可以避开网中的拥塞部分，因此网络的健壮性较好。对于分组的传送比虚电路更为可靠
- 线路利用率较高；异种终端通信；数据传输质量好、可靠性高；负荷控制；经济性好
- 信息传送时延大；每个分组附加的分组头都需要交换机进行分析处理，从而增加了开销；不适合 于在实时性要求高、信息量大的环境中应用；协议和控制比较复杂
- 优点：用户的通信不需要有建立连接和清除连接的过程，对于短报文通信效率比较高；每个节点可以自由地选路，可以避开网中的拥塞部分，因此网络的健壮性较好；对于分组的传送比虚电路更为可靠，如果一个节点出现故障，分组可以通过其它路由传送。
- 缺点：分组的到达不按顺序，在终点各分组需重新排队；每个分组的分组头要包含详细的目的地址，开销比较大。
- 使用场合：数据报适用于短报文的传送，如询问/响应型业务等

#### X.25 协议

- 数据电路终接设备DCE：调制解调器/多路复用器/数字设备
- 数据终端设备DTE：终端/计算机
- 分为三层：物理层、链路层、分组层
- 物理层定义了DTE和DCE之间建立、维持、释放物理链路的过程，包括机械、电气、功能和过程特性
- 链路层规定了在DTE和DCE之间的线路上交换X.25帧的过程。在物理 层提供的双向的信息传送管道上实施信息传输的控制。
- X.25产生的时代是模拟通信占主导作用的时代，模拟传输的特点是误码率高，线路带宽小，需要采用复杂的差错控制和流量控制保证数据传输的可靠性

#### 帧中继

- 帧中继取消分组交换技术中的数据报方式，仅采用虚电路方式，向用 户提供面向连接的数据链路层服务。
- 帧中继是在链路层进行统计复用的
- 帧中继协议取消了X.25的分组层功能，只有两个层次：物理层和数据 链路层
- DLCI为数据链路连接标识符，类似于X.25中的逻辑信道号LCN，DLCI只有局部(本地)意义。识别UNI或NNI接口上的永久虚连接、呼叫控制或管理信息。当帧进入网络时帧中继通过DLCI值识别帧的去向。

##### 帧中继与X.25的区别

- x.25协议控制复杂，要逐段进行链路上的差错控制、流量控制，因此处理速度慢，时延较大，不能很好地满足实时性业务的需要；帧中继的响应时间短、高速率、高吞吐量、低时延满足用户是实时性业务、宽带业务的需要。

#### ATM

- 采用固定长度的短分组。
- 采用统计复用。
- 采用面向连接并预约传输资源的方式工作
- 取消逐段链路的差错控制和流量控制
- ATM信元头部的功能降低
- ATM信元头部作用：信元头部包含各种控制信息，主要是表示信元去向的逻辑地址，还有一些维护信息、优先级以及信头的纠错码。
- VPI/VCI的作用：VPI虚通道标识符 VCI虚信道标识符。VPI/VCI是ATM传输的名词，ATM把一条物理电路划分为几个虚拟的逻辑电路，称为VPI，然后在每一个VPI中再划分虚拟的信道，称为VCI。

## 计算机网络

-  因特网中最复杂的部分，向网络边缘中的大量主机提供连通性
-  路由器是实现分组交换(packet switching)的关键构件，其任务是转发收到的分组，这是网络核心部分最重要的功能

- 带宽：本来指信号具有的频带宽度，单位是赫兹（Hz）
- 现在指数字信道所能传送的“最高数据率”的同义语，单位是比特每秒（bit/s） 
- 吞吐量：在单位时间内通过某个网络（或信道、接口）的数据量；受网络的带宽或网络的额定速率的限制
- 时延：
  - 发送时延 = 数据块长度（bit）÷ 发送速率（bit/s）
  - 传播时延 = 信道长度（米）÷ 信号传播速率（米/秒）
- 协议三要素：
  - 语法：数据与控制信息的结构或格式
  - 语义：需要发出何种控制信息，完成何种动作以及做出何种响应
  - 同步：事件实现顺序的详细说明
* TCP/IP 体系
- 应用层：直接为用户的应用进程提供服务
- 运输层：负责两个主机中进程之间的通信提供服务。复用/分用
  - 传输控制协议TCP：面向连接，可靠交付，报文段
  - 用户数据报协议UDP：无连接，尽最大努力交付，数据段
- 网络层：负责为分组交换上不同主机提供通信服务。分段/重装
  - 把报文段/数据报封装成分组或包。无连接的网络协议IP，网际层/IP层
- 数据链路层：将IP数据报组装成帧；两个相邻结点间传送数据
- 物理层：透明地传输比特流

### 实体、协议、服务和服务访问点

- 实体(entity)表示任何可发送或接收信息的硬件或软件进程
  - 协议是控制两个对等实体进行通信的规则的集合
  - 本层协议用于向上一层提供服务；要实现本层协议，还需要使用下层所提供的服务
- 协议是“水平的”：是对等实体之间的通信规则
- 服务是“垂直的”：是由下层向上层通过层间接口提供的

### 物理层

- 物理层考虑如何在连接各种计算机的传输媒体上传输比特流；尽可能屏蔽掉物理设备传输媒体和通信手段的不同
- 物理层的主要任务描述为确定与传输媒体的接口的一些特性
  - 机械特性：指明接口所用接线器的形状和尺寸、引线数目和排列、固定和锁定装置等等
  - 电气特性：指明在接口电缆的各条线上出现的电压的范围
  - 功能特性：指明某条线上出现的某一电平的电压表示何种意义
  - 过程特性：指明对于不同功能的各种可能事件的出现顺序
  - 并/串转换：数据在通信线路上的传输方式一般为串行传输/逐个比特
- 信息交互的方式：
  - 单向通信/单工通信：只能有一个方向的通信而没有反方向的交互
  - 双向交替通信/半双工通信：通信的双方都可以发送信息，但不能双方同时发送(当然也就不能同时接收)
  - 双向同时通信/全双工通信：通信的双方可以同时发送和接收信息
- 传输媒体：
  - 双绞线
  - 同轴电缆
  - 光纤
  - 无线传输
- DMT(Discrete Multi-Tone) 离散多音调调制技术
- FDM(frequency division multiplexing) 频分复用
- TDM(Time Division Multiplexing) 时分复用
- STDM(Statistic Time Division Multiplexing) 统计时分复用
- WDM(Wave Division Multiplexing) 波分复用，就是光的频分复用
- DWDM(Dense Wave Division Multiplexing) 密集波分复用
- 码分多址（CDMA）：
  - 每一个用户可以在同样的时间使用同样的频带进行通信
  - 各用户使用经过特殊挑选的不同码型，不会造成相互干扰(正交) 
- ADSL：非对称数字用户线
  - 上行：用户到 ISP（带宽窄）
  - 下行：ISP 到用户（带宽宽）
  - ADSL 在用户线（铜线）的两端各安装一个 ADSL 调制解调器

### 数据链路层

- 链路（link）是从一个结点到相邻结点的一条物理线路(无源)，一条链路只是一条通路的一个组成部分，在物理线路上，还必须有必要的通信协议来控制数据的传输
- 若把实现这些协议的硬件和软件加到链路上，就构成了数据链路
- 数据链路层的协议数据单元是帧
- 封装成帧（framing）
  - 在一段数据的前后分别添加首部和尾部，然后就构成了一个帧；首部和尾部用于帧定界并且包含许多必要的控制信息
  - 帧长=数据部分+帧头和帧尾的长度；帧的数据部分最大长度：MTU
- 透明传输：
  - 帧的数据部分理论上不允许出现帧定界符，为了使不管什么字符都可以放在这个帧中传输，需要使用字符填充：
  - 发送端在数据中出现控制字符SOH和EOT的前面插入一个转义字符 ESC
  - 接收端的在将数据送往网络层前删除这个插入的转义字符 
- 差错控制：
  - 循环冗余校验 CRC
  - 发送端：数据划分为 k bit/组
  - CRC 运算产生 n bit冗余码，即帧检校序列 FCS
  - 帧 = 数据 + 冗余码
  - 如何产生帧校验序列FCS：
    - 待传输数据除以校验序列取余数，将余数加在数据后
    - 用多项式/生成多项式表示循环冗余校验序列：P(X)=X3+X2+1表示除数P=1101
- 点对点协议 PPP
  - PPP 协议不需要的功能
    - 纠错：只负责检错，是不可靠传输协议。可靠性由运输层TCP负责
    - 流量控制：端到端的流量由TCP负责
  - 零比特填充：
    - 连续发 5 个“1”后填入一个“0”
  - 工作状态：
    - 




## 应用层

- 应用层是网络应用程序及它们的应用层协议存留的地方

### 应用层协议原理

- 在两个不同端系统上的进程，通过跨越计算机网络交换报文（message）而相互通信
- 进程通过一个称为套接字（socket）的软件接口（API）向网络发送报文和从网络接收报文

#### 因特网提供的运输服务

- 因特网为应用程序提供两个运输层协议：UDP 和 TCP

##### TCP 服务

- 面向连接的服务：在应用层数据报文开始流动之前，TCP 让客户和服务器互相交换运输层控制信息。在握手阶段后，一个 TCP 连接就在两个进程的 socket 之间建立了，这条连接是全双工的
- 可靠的数据传输服务：通信进程能够依靠 TCP 无差错、按适当顺序交付所有发送的数据，当应用程序的一端将字节流传进 socket 时，他能够依靠 TCP 将相同的字节流交付给接受方的 socket，而没有字节的丢失和冗余

##### TCP 安全

- 无论是 TCP 还是 UDP 都没有任何加密机制，所以研制了安全套接字层（Secure Sockets Layer, SSL）用 SSL 加强后的 TCP 提供了关键的进程到进程的安全性服务，包括加密、数据完整性和端点鉴别

## 运输层

- 运输层在应用程序端点之间传送应用层报文
- TCP 提供面向连接的服务

## 网络层

- 网络层负责将数据报（datagram）的网络层分组从一台主机移动到另一台主机